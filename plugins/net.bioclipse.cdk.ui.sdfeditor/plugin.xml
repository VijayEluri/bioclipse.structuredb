<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.2"?>
<plugin>
   <extension-point id="net.bioclipse.cdk.propertyCalculator" name="PropertyCalculator" schema="schema/net.bioclipse.cdk.propertyCalculator.exsd"/>
   <extension
         point="org.eclipse.ui.editors">
      <editor
            class="net.bioclipse.cdk.ui.sdfeditor.editor.MultiPageMoleculesEditorPart"
            default="true"
            extensions="sdf,smi"
            icon="icons/many_molecules.png"
            id="net.bioclipse.cdk.ui.sdfeditor"
            name="MoleculeTableEditor">
         <contentTypeBinding
               contentTypeId="net.bioclipse.contenttypes.sdf2d">
         </contentTypeBinding>
         <contentTypeBinding
               contentTypeId="net.bioclipse.contenttypes.sdf3d">
         </contentTypeBinding>
         <contentTypeBinding
               contentTypeId="net.bioclipse.contenttypes.cml.multipleMolecule2d">
         </contentTypeBinding>
         <contentTypeBinding
               contentTypeId="net.bioclipse.contenttypes.cml.multipleMolecule3d">
         </contentTypeBinding>
      </editor>
   </extension>
   
      <extension
         point="net.bioclipse.ui.business.editorShortname">
         <shortname
               alias="sdf"
               editorID="net.bioclipse.cdk.ui.sdfeditor">
         </shortname>
         <shortname
               alias="multimol"
               editorID="net.bioclipse.cdk.ui.sdfeditor">
         </shortname>
   </extension>
   
      <extension
         point="net.bioclipse.ui.bioobjectDescriber">
		<BioObject
	        describer="net.bioclipse.cdk.ui.sdfeditor.describer.MolTableDescriber"
    	    id="net.bioclipse.cdk.jchempaint.describer"
    	    objectClass="net.bioclipse.core.domain.BioList">
		</BioObject>         
   </extension>
   
   
   <extension
         point="org.eclipse.core.expressions.definitions">
      <definition
            id="net.bioclipse.cdk.ui.sdfeditor.jcptab">
         <or>
            <with
                  variable="activeEditor">
               <instanceof
                     value="net.bioclipse.cdk.jchempaint.editor.JChemPaintEditor">
               </instanceof>
            </with>
            <with
                  variable="activePart">
               <instanceof
                     value="net.bioclipse.cdk.ui.sdfeditor.editor.MultiPageMoleculesEditorPart">
               </instanceof>
            </with>
         </or>
      </definition>
   </extension>

      <extension
         point="org.eclipse.ui.newWizards">
      <category
            id="net.bioclipse.cdk.ChemistryFiles"
            name="Chemistry Files"/>
      <wizard
            canFinishEarly="false"
            category="net.bioclipse.cdk.ChemistryFiles"
            class="net.bioclipse.cdk.ui.wizards.NewSdfWizard"
            hasPages="true"
            icon="icons/many_molecules.png"
            id="net.bioclipse.cdk.ui.wizards.NewSdfWizard"
            name="SD File (from existing structures)">
         <description>
         Create a new SD file.
         </description>
      </wizard>
   </extension>

   <extension
         point="org.eclipse.help.toc">
      <toc
            file="toc.xml"
            primary="true"/>
   </extension>

    <extension
        point="org.eclipse.ui.commands">
        <command
           id="net.bioclipse.cdk.sdfeditor.handlers.extractEntries"
           defaultHandler="net.bioclipse.cdk.ui.sdfeditor.handlers.ExtractEntriesHandler"
           name="extractEntries"/>
        <command
              defaultHandler="net.bioclipse.cdk.ui.sdfeditor.handlers.OpenJCPTab"
              id="net.bioclipse.cdk.ui.sdfeditor.open.jcp"
              name="Open 2D-structure tab">
        </command>
        <command
              defaultHandler="net.bioclipse.cdk.ui.sdfeditor.handlers.CalculatePropertyHandler"
              id="net.bioclipse.cdk.ui.sdfeditor.addProperty"
              name="Add Property">
           <commandParameter
                 id="net.bioclipse.cdk.ui.sdfeditor.calculatorId"
                 name="calculatorId"
                 optional="false">
           </commandParameter>
        </command>
  	</extension>

	<extension
  		point="org.eclipse.ui.menus">
		<menuContribution
			locationURI="popup:org.eclipse.ui.popup.any?after=additions">
		    <command
		    	commandId="net.bioclipse.cdk.sdfeditor.handlers.extractEntries"
		    	label="Extract Entries"
		        icon="icons/many_molecules.png">
		      	<visibleWhen>
			   		<iterate operator="and" ifEmpty="false">
		      			<adapt type="org.eclipse.core.resources.IResource">
			      			<or>
				                <test property="org.eclipse.core.resources.contentTypeId"
				           	    	value="net.bioclipse.contenttypes.sdf"/>
				            </or>
			      		</adapt>
			   		</iterate>
		        </visibleWhen>
	       </command>
		</menuContribution>
  <menuContribution
        locationURI="popup:net.bioclipse.cdk.ui.sdfeditor.menu?after=additions">
     <command
           commandId="net.bioclipse.cdk.ui.sdfeditor.open.jcp"
           label="Open"
           style="push"
           tooltip="Open 2D-strcuture edtior">
        <visibleWhen
              checkEnabled="true">
           <iterate>
              <instanceof
                    value="net.bioclipse.cdk.domain.ICDKMolecule">
              </instanceof>
           </iterate>
        </visibleWhen>
     </command>
     <command
           commandId="net.bioclipse.cdk.ui.sdfeditor.addProperty"
           label="Calculate number of atoms property"
           style="push">
        <parameter
              name="net.bioclipse.cdk.ui.sdfeditor.calculatorId"
              value="net.bioclipse.cdk.calculator.numberOfAtoms">
        </parameter>
        <visibleWhen
              checkEnabled="false">
           <with
                 variable="activeEditor">
              <instanceof
                    value="net.bioclipse.cdk.ui.sdfeditor.editor.MultiPageMoleculesEditorPart">
              </instanceof>
           </with>
        </visibleWhen>
     </command>
  </menuContribution>
	</extension>
 <extension
       point="net.bioclipse.scripting.contribution">
    <scriptContribution
          id="net.bioclipse.cdk.ui.sdfeditor.business.MoleculeTableManager"
          service="net.bioclipse.cdk.ui.sdfeditor.business.MoleculeTableManagerFactory">
    </scriptContribution>
 </extension>
 <extension
       id="net.bioclipse.cdk.calculator.numberOfAtoms"
       point="net.bioclipse.cdk.propertyCalculator">
    <Calculator
          class="net.bioclipse.cdk.ui.sdfeditor.NumberOfAtomCalculator">
    </Calculator>
 </extension>
</plugin>
